import{y as S,c as E,d as V,N as u,a as g,D as P,k as p,o as c,j as a,b as x,A as i,B as y,F as T,r as H,t as k,G as M,K as A,H as N,U,i as R,z as G,P as I,V as j,l as z,m as K}from"./index-Ce_smM0X.js";import{v as q}from"./vuetify-BC_h0XMe.js";import{d as J,s as B,c as O}from"./pinia-ey_1N9KB.js";import{M as m,v as Q,G as C}from"./replicant_store-DDWmZYDe.js";import{D as W}from"./vuedraggable.umd-CwaN1Msl.js";import{M as F}from"./MediaCard-CQGdsCYj.js";import"./_commonjsHelpers-BosuxZz1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";let h;const $=J("videoPlayer",()=>{const b=S(!1),o=S(!1),s=S([]),r=S("intermission");function n(){var d,_;s.value=((d=m.data)==null?void 0:d.playlist)??[],r.value=((_=m.data)==null?void 0:_.finishScene)??"intermission",o.value=!1}function e(){o.value=!0,clearTimeout(h),h=window.setTimeout(()=>{n()},30*1e3)}function t(d){s.value.push(d),e()}function l(d){r.value=d,e()}const v=E({get:()=>r.value,set:d=>{r.value=d,e()}});async function w(){m.data&&(b.value=!0,m.data.playlist=Q(s.value),m.data.finishScene=r.value,m.save(),await new Promise(d=>{setTimeout(d,1e3)}),b.value=!1,clearTimeout(h),o.value=!1)}return{disableSave:b,localEdits:o,newPlaylist:s,newFinishScene:r,finishSceneModel:v,save:w,playlistAdd:t,setFinishScene:l,onLocalEdits:e,resetLocalPlaylist:n}}),X={key:0},Y={style:{"margin-top":"10px"}},Z={key:0,style:{"font-style":"italic"}},ee={style:{height:"250px","overflow-y":"scroll","overflow-x":"hidden",margin:0,padding:"10px"}},te=["data-value"],le={class:"d-flex align-center",style:{"margin-right":"10px"}},ne={style:{width:"25px","text-align":"center"}},ae=["title"],oe=V({__name:"AvailableVideos",setup(b){const o=$(),s=S(null);function r(e){var t,l;return((l=(t=m.data)==null?void 0:t.plays)==null?void 0:l[e])||0}const n=E(()=>C.value.filter(e=>{const t=s.value?s.value.toLowerCase():"";return!t||t&&e.name.toLowerCase().includes(t)}).map(e=>[r(e.sum),e]).sort().map(e=>e[1]));return(e,t)=>{var _;const l=u("v-toolbar-title"),v=u("v-text-field"),w=u("v-icon"),d=u("v-btn");return p(m).data?(c(),g("div",X,[a(l,null,{default:i(()=>t[1]||(t[1]=[y(" Available Videos ")])),_:1}),x("div",Y,[(_=p(C))!=null&&_.length?(c(),g(T,{key:1},[a(v,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=f=>s.value=f),filled:"",clearable:"",label:"Search...","append-icon":"mdi-magnify",messages:`
            ${n.value.length} video${n.value.length===1?"":"s"} found.
          `},null,8,["modelValue","messages"]),x("div",ee,[(c(!0),g(T,null,H(n.value,f=>(c(),g("div",{key:f.sum,class:"d-flex align-center","data-value":f.sum,style:{margin:"5px","margin-left":0}},[x("div",le,[a(d,{icon:"",outlined:"",small:"",style:{"margin-right":"10px"},onClick:D=>p(o).playlistAdd(f.sum)},{default:i(()=>[a(w,{small:""},{default:i(()=>t[2]||(t[2]=[y(" mdi-playlist-plus ")])),_:1})]),_:2},1032,["onClick"]),a(w,null,{default:i(()=>t[3]||(t[3]=[y(" mdi-play ")])),_:1}),x("div",ne,k(r(f.sum)),1)]),x("div",{title:f.name},k(f.name),9,ae)],8,te))),128))])],64)):(c(),g("span",Z,' Add videos under "Assets" > "esa-layouts" > "Videos". '))])])):P("",!0)}}}),se={class:"d-flex justify-center flex-grow-1",style:{overflow:"hidden","font-style":"italic"}},ie=V({__name:"Playlist",setup(b){const o=$(),{newPlaylist:s,localEdits:r}=B(o);function n(t){var l;return(l=C.value.find(v=>v.sum===t))==null?void 0:l.name}function e(t){o.newPlaylist.splice(t,1),o.onLocalEdits()}return(t,l)=>{const v=u("v-toolbar-title"),w=u("v-alert"),d=u("v-icon");return c(),g("div",null,[a(v,null,{default:i(()=>l[1]||(l[1]=[y(" Playlist ")])),_:1}),M(a(w,{type:"warning",dense:"",style:{"margin-top":"5px"}},{default:i(()=>l[2]||(l[2]=[y(" Local changes have been made. ")])),_:1},512),[[N,p(r)]]),p(s).length?P("",!0):(c(),A(F,{key:0,style:{"font-style":"italic"}},{default:i(()=>l[3]||(l[3]=[y(" Add videos using the list above. ")])),_:1})),a(p(W),{modelValue:p(s),"onUpdate:modelValue":l[0]||(l[0]=_=>U(s)?s.value=_:null)},{item:i(({element:_,index:f})=>[(c(),A(F,{key:`${_}_${f}`,class:"d-flex align-center"},{default:i(()=>[x("div",se,k(n(_)||"Could not find video name."),1),a(d,{onClick:D=>e(f),class:"mr-1"},{default:i(()=>l[4]||(l[4]=[y(" mdi-delete ")])),_:2},1032,["onClick"])]),_:2},1024))]),_:1},8,["modelValue"])])}}}),re={key:0,style:{"text-align":"center"}},de={key:0},ue={key:1},me=V({__name:"CurrentVideoInfo",setup(b){const o=E(()=>{var r;return(r=C.value.find(n=>{var e;return n.sum===((e=m.data)==null?void 0:e.current)}))==null?void 0:r.name});function s(){nodecg.sendMessage("stopFullScreenVideoPlayerEarly")}return(r,n)=>{const e=u("v-btn");return p(m).data?M((c(),g("div",re,[n[1]||(n[1]=x("span",{class:"font-weight-bold"},"Currently Playing:",-1)),n[2]||(n[2]=x("br",null,null,-1)),o.value?(c(),g("span",de,k(o.value),1)):(c(),g("span",ue,"Unknown (Usually Commercial w/o Video)")),a(e,{color:"red",class:"mt-2",onClick:s,block:""},{default:i(()=>n[0]||(n[0]=[y("Emergency Stop")])),_:1})],512)),[[N,p(m).data.playing]]):P("",!0)}}}),ce=V({__name:"SceneControl",setup(b){const o=$(),{finishSceneModel:s}=B(o);return(r,n)=>{const e=u("v-toolbar-title"),t=u("v-radio"),l=u("v-radio-group");return c(),g("div",null,[a(e,null,{default:i(()=>n[1]||(n[1]=[y(" Target scene on playlist end: ")])),_:1}),a(l,{style:{"margin-top":"5px"},modelValue:p(s),"onUpdate:modelValue":n[0]||(n[0]=v=>U(s)?s.value=v:null)},{default:i(()=>[a(t,{label:"Intermission",value:"intermission"}),a(t,{label:"Game Layout",value:"gameLayout"}),a(t,{label:"Interview",value:"interview"})]),_:1},8,["modelValue"])])}}}),pe={class:"d-flex",style:{"margin-top":"10px"}},ve=V({__name:"main",setup(b){R({title:"Full Screen Player control"});const o=$();function s(){o.resetLocalPlaylist()}G(()=>m.data,()=>{o.localEdits||o.resetLocalPlaylist()},{immediate:!0});async function r(){m.data&&await o.save()}return(n,e)=>{const t=u("v-btn"),l=u("v-icon"),v=u("v-tooltip"),w=u("v-app");return p(m).data?(c(),A(w,{key:0},{default:i(()=>[a(oe),a(ie,{style:{"margin-top":"20px"}}),a(ce,{style:{"margin-top":"20px"}}),x("div",pe,[a(t,{class:"flex-grow-1",loading:p(o).disableSave,disabled:p(o).disableSave,onClick:e[0]||(e[0]=d=>r())},{default:i(()=>e[2]||(e[2]=[y(" Save ")])),_:1},8,["loading","disabled"]),a(v,{left:""},{activator:i(({targetRef:d})=>[a(t,I({style:{"margin-left":"5px"},onClick:e[1]||(e[1]=_=>s())},j(d)),{default:i(()=>[a(l,null,{default:i(()=>e[3]||(e[3]=[y(" mdi-refresh ")])),_:1})]),_:2},1040)]),default:i(()=>[e[4]||(e[4]=x("span",null,"Revert Local Changes",-1))]),_:1})]),a(me,{style:{"margin-top":"10px"}})]),_:1})):P("",!0)}}}),L=z(ve),_e=K(),fe=O();L.use(_e);L.use(q);L.use(fe);L.mount("#app");
