import{g as be,c as h}from"./_commonjsHelpers-BosuxZz1.js";import{y as B,U as we,z as Re,v as De,a3 as Oe}from"./index-Ce_smM0X.js";var x={},ae={exports:{}};(function(n){var e=function(){function t(d,p){return p!=null&&d instanceof p}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var o;try{o=Promise}catch{o=function(){}}function s(d,p,R,S,z){typeof p=="object"&&(R=p.depth,S=p.prototype,z=p.includeNonEnumerable,p=p.circular);var Y=[],Z=[],ye=typeof Buffer<"u";typeof p>"u"&&(p=!0),typeof R>"u"&&(R=1/0);function D(a,O){if(a===null)return null;if(O===0)return a;var v,A;if(typeof a!="object")return a;if(t(a,r))v=new r;else if(t(a,i))v=new i;else if(t(a,o))v=new o(function(E,M){a.then(function(P){E(D(P,O-1))},function(P){M(D(P,O-1))})});else if(s.__isArray(a))v=[];else if(s.__isRegExp(a))v=new RegExp(a.source,_(a)),a.lastIndex&&(v.lastIndex=a.lastIndex);else if(s.__isDate(a))v=new Date(a.getTime());else{if(ye&&Buffer.isBuffer(a))return Buffer.allocUnsafe?v=Buffer.allocUnsafe(a.length):v=new Buffer(a.length),a.copy(v),v;t(a,Error)?v=Object.create(a):typeof S>"u"?(A=Object.getPrototypeOf(a),v=Object.create(A)):(v=Object.create(S),A=S)}if(p){var Q=Y.indexOf(a);if(Q!=-1)return Z[Q];Y.push(a),Z.push(v)}t(a,r)&&a.forEach(function(E,M){var P=D(M,O-1),_e=D(E,O-1);v.set(P,_e)}),t(a,i)&&a.forEach(function(E){var M=D(E,O-1);v.add(M)});for(var b in a){var J;A&&(J=Object.getOwnPropertyDescriptor(A,b)),!(J&&J.set==null)&&(v[b]=D(a[b],O-1))}if(Object.getOwnPropertySymbols)for(var k=Object.getOwnPropertySymbols(a),b=0;b<k.length;b++){var N=k[b],T=Object.getOwnPropertyDescriptor(a,N);T&&!T.enumerable&&!z||(v[N]=D(a[N],O-1),T.enumerable||Object.defineProperty(v,N,{enumerable:!1}))}if(z)for(var ee=Object.getOwnPropertyNames(a),b=0;b<ee.length;b++){var U=ee[b],T=Object.getOwnPropertyDescriptor(a,U);T&&T.enumerable||(v[U]=D(a[U],O-1),Object.defineProperty(v,U,{enumerable:!1}))}return v}return D(d,R)}s.clonePrototype=function(p){if(p===null)return null;var R=function(){};return R.prototype=p,new R};function l(d){return Object.prototype.toString.call(d)}s.__objToStr=l;function g(d){return typeof d=="object"&&l(d)==="[object Date]"}s.__isDate=g;function y(d){return typeof d=="object"&&l(d)==="[object Array]"}s.__isArray=y;function m(d){return typeof d=="object"&&l(d)==="[object RegExp]"}s.__isRegExp=m;function _(d){var p="";return d.global&&(p+="g"),d.ignoreCase&&(p+="i"),d.multiline&&(p+="m"),p}return s.__getRegExpFlags=_,s}();n.exports&&(n.exports=e)})(ae);var H=ae.exports;const L=be(H);var C={},q={exports:{}},j=typeof Reflect=="object"?Reflect:null,te=j&&typeof j.apply=="function"?j.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},K;j&&typeof j.ownKeys=="function"?K=j.ownKeys:Object.getOwnPropertySymbols?K=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:K=function(e){return Object.getOwnPropertyNames(e)};function xe(n){console&&console.warn&&console.warn(n)}var ue=Number.isNaN||function(e){return e!==e};function c(){c.init.call(this)}q.exports=c;q.exports.once=je;c.EventEmitter=c;c.prototype._events=void 0;c.prototype._eventsCount=0;c.prototype._maxListeners=void 0;var ne=10;function V(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return ne},set:function(n){if(typeof n!="number"||n<0||ue(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");ne=n}});c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};c.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ue(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function fe(n){return n._maxListeners===void 0?c.defaultMaxListeners:n._maxListeners}c.prototype.getMaxListeners=function(){return fe(this)};c.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw l.context=s,l}var g=o[e];if(g===void 0)return!1;if(typeof g=="function")te(g,this,t);else for(var y=g.length,m=he(g,y),r=0;r<y;++r)te(m[r],this,t);return!0};function ce(n,e,t,r){var i,o,s;if(V(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),s=o[e]),s===void 0)s=o[e]=t,++n._eventsCount;else if(typeof s=="function"?s=o[e]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),i=fe(n),i>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=n,l.type=e,l.count=s.length,xe(l)}return n}c.prototype.addListener=function(e,t){return ce(this,e,t,!1)};c.prototype.on=c.prototype.addListener;c.prototype.prependListener=function(e,t){return ce(this,e,t,!0)};function Le(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function le(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=Le.bind(r);return i.listener=t,r.wrapFn=i,i}c.prototype.once=function(e,t){return V(t),this.on(e,le(this,e,t)),this};c.prototype.prependOnceListener=function(e,t){return V(t),this.prependListener(e,le(this,e,t)),this};c.prototype.removeListener=function(e,t){var r,i,o,s,l;if(V(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){l=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Se(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this};c.prototype.off=c.prototype.removeListener;c.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function de(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Te(i):he(i,i.length)}c.prototype.listeners=function(e){return de(this,e,!0)};c.prototype.rawListeners=function(e){return de(this,e,!1)};c.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):ve.call(n,e)};c.prototype.listenerCount=ve;function ve(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}c.prototype.eventNames=function(){return this._eventsCount>0?K(this._events):[]};function he(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function Se(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Te(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function je(n,e){return new Promise(function(t,r){function i(s){n.removeListener(e,o),r(s)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}me(n,e,o,{once:!0}),e!=="error"&&Ce(n,i,{once:!0})})}function Ce(n,e,t){typeof n.on=="function"&&me(n,"error",e,t)}function me(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Ae=q.exports;Object.defineProperty(C,"__esModule",{value:!0});C.onTimerChange=void 0;const Ee=Ae;let Me=class extends Ee.EventEmitter{static formPlayerNamesStr(e){return e.teams.map(t=>t.players.map(r=>r.name).join(", ")).join(" vs. ")||"N/A"}static getRunTotalPlayers(e){return e.teams.reduce((t,r)=>t+r.players.reduce(i=>i+1,0),0)}};function Pe(n,e,t,r){if(!e||!t)return;const i=t.state,o=e.state;i!==o&&(o==="running"?i==="paused"?n.emit("timerResumed"):i==="stopped"&&n.emit("timerStarted"):o==="finished"?n.emit("timerStopped"):o==="paused"?n.emit("timerPaused"):o==="stopped"&&n.emit("timerReset")),r&&r.forEach(s=>{if(["paused","stopped"].includes(o)&&i===o&&s.path==="/"&&s.method==="update"&&s.args.prop==="milliseconds"&&n.emit("timerEdited"),s.path==="/teamFinishTimes"&&"args"in s&&"prop"in s.args){const l=s.args.prop,g=e.teamFinishTimes[l];s.method==="add"?n.emit("timerTeamStopped",l,g.state==="forfeit"):s.method==="delete"&&n.emit("timerTeamUndone",l)}})}C.onTimerChange=Pe;C.default=Me;var Be=h&&h.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ie=h&&h.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ne=h&&h.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Be(e,n,t);return Ie(e,n),e},F=h&&h.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(m){try{y(r.next(m))}catch(_){s(_)}}function g(m){try{y(r.throw(m))}catch(_){s(_)}}function y(m){m.done?o(m.value):i(m.value).then(l,g)}y((r=r.apply(n,e||[])).next())})},Ue=h&&h.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};const re=Ue(H),ie=Ne(C),w="nodecg-speedcontrol";let Fe=class extends ie.default{constructor(e){super(),this.runDataArray=e.Replicant("runDataArray",w),this.runDataActiveRun=e.Replicant("runDataActiveRun",w),this.runDataActiveRunSurrounding=e.Replicant("runDataActiveRunSurrounding",w),this.timer=e.Replicant("timer",w),this.runFinishTimes=e.Replicant("runFinishTimes",w),this.twitchCommercialTimer=e.Replicant("twitchCommercialTimer",w),this.timerChangesDisabled=e.Replicant("timerChangesDisabled",w),this.nodecg=e,this.timer.on("change",(t,r,i)=>{(0,ie.onTimerChange)(this,t,r,i)})}getCurrentRun(){return(0,re.default)(this.runDataActiveRun.value)}getRunDataArray(){return(0,re.default)(this.runDataArray.value||[])}getNextRuns(e=4,t){const r=this.runDataActiveRunSurrounding.value?this.runDataActiveRunSurrounding.value.next:void 0;let i=this.findRunIndex(t||r);return i=t?i+=1:i,this.getRunDataArray().slice(i,i+e)}findRunIndex(e){let t=e;return e&&typeof e!="string"&&(t=e.id),this.getRunDataArray().findIndex(r=>r.id===t)}startTimer(){return F(this,void 0,void 0,function*(){return this.nodecg.sendMessageToBundle("timerStart",w)})}stopTimer(e=0){return F(this,void 0,void 0,function*(){const t=this.getCurrentRun();let r;if(t&&t.teams[e]&&(r=t.teams[e].id),t&&!r)throw new Error(`Run is active but team with index ${e} unavailable`);return this.nodecg.sendMessageToBundle("timerStop",w,{id:r})})}resetTimer(){return F(this,void 0,void 0,function*(){return this.nodecg.sendMessageToBundle("timerReset",w)})}disableTimerChanges(){this.timerChangesDisabled.value=!0}enableTimerChanges(){this.timerChangesDisabled.value=!1}startTwitchCommercial(e){return F(this,void 0,void 0,function*(){return this.nodecg.sendMessageToBundle("twitchStartCommercial",w,{duration:e})})}};var $e=Fe,Ke=h&&h.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ve=h&&h.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),We=h&&h.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Ke(e,n,t);return Ve(e,n),e},$=h&&h.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(m){try{y(r.next(m))}catch(_){s(_)}}function g(m){try{y(r.throw(m))}catch(_){s(_)}}function y(m){m.done?o(m.value):i(m.value).then(l,g)}y((r=r.apply(n,e||[])).next())})},ze=h&&h.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};const se=ze(H),oe=We(C),G="nodecg-speedcontrol";class Je extends oe.default{constructor(e){super();const t=r=>e.Replicant(r,G);this.runDataArray=t("runDataArray"),this.runDataActiveRun=t("runDataActiveRun"),this.runDataActiveRunSurrounding=t("runDataActiveRunSurrounding"),this.timer=t("timer"),this.runFinishTimes=t("runFinishTimes"),this.twitchCommercialTimer=t("twitchCommercialTimer"),this.timerChangesDisabled=t("timerChangesDisabled"),this.sendMessage=e.extensions[G].sendMessage,this.listenFor=e.extensions[G].listenFor,this.timer.on("change",(r,i,o)=>{(0,oe.onTimerChange)(this,r,i,o)})}getCurrentRun(){return(0,se.default)(this.runDataActiveRun.value)}getRunDataArray(){return(0,se.default)(this.runDataArray.value)}getNextRuns(e=4,t){let r=this.findRunIndex(t||this.runDataActiveRunSurrounding.value.next);return r=t?r+=1:r,this.getRunDataArray().slice(r,r+e)}findRunIndex(e){let t=e;return e&&typeof e!="string"&&(t=e.id),this.getRunDataArray().findIndex(r=>r.id===t)}startTimer(){return $(this,void 0,void 0,function*(){return this.sendMessage("timerStart")})}stopTimer(e=0){return $(this,void 0,void 0,function*(){const t=this.getCurrentRun();let r;if(t&&t.teams[e]&&(r=t.teams[e].id),t&&!r)throw new Error(`Run is active but team with index ${e} unavailable`);return this.sendMessage("timerStop",{id:r})})}resetTimer(){return $(this,void 0,void 0,function*(){return this.sendMessage("timerReset")})}disableTimerChanges(){this.timerChangesDisabled.value=!0}enableTimerChanges(){this.timerChangesDisabled.value=!1}startTwitchCommercial(e){return $(this,void 0,void 0,function*(){return this.sendMessage("twitchStartCommercial",{duration:e})})}}var Ge=Je,pe=h&&h.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(x,"__esModule",{value:!0});var ge=x.SpeedcontrolUtilBrowser=x.SpeedcontrolUtilServer=x.SpeedcontrolUtil=void 0;const He=pe($e),X=pe(Ge);x.default=X.default;x.SpeedcontrolUtil=X.default;x.SpeedcontrolUtilServer=X.default;ge=x.SpeedcontrolUtilBrowser=He.default;function f(n,e,t={}){var r;return(r=qe(n,e,t))===null||r===void 0?void 0:r.reactiveReplicant}function qe(n,e,t){if(we(n))return console.warn(`Tried to create a StaticReplicant using a reactive name (${n.value})`),null;t===void 0&&typeof e!="string"&&(t=e);let r=typeof e=="string"?nodecg.Replicant(n,e,t):nodecg.Replicant(n,t);const i=B(L(t==null?void 0:t.defaultValue)),o=B(L(t==null?void 0:t.defaultValue)),s=B(!1),l=B(!0);function g(){s.value=JSON.stringify(i.value)!==JSON.stringify(o.value)}Re(i,g,{deep:!0});const y=(R,S)=>{o.value=L(R),S||(s.value=!1),s.value?(g(),l.value=!s.value):(i.value=L(o.value),l.value=!0)};r.on("change",y);function m(){r.value=i.value}function _(){i.value=L(o.value)}function d(){i.value=L(t==null?void 0:t.defaultValue)}return{reactiveReplicant:De({data:i,oldData:Oe(o),changed:s,save:m,revert:_,loadDefault:d}),listener:y}}function I(n,e){const t=nodecg.Replicant(`assets:${n}`,e),r=B([]);return t.on("change",i=>{r.value=L(i??[])}),r}const u="esa-layouts",W="nodecg-speedcontrol",Xe=new ge(nodecg),et=f("additionalDonations",u),tt=I("donation-alert-assets",u),nt=I("intermission-slides",u),rt=I("media-box-images",u);I("reader-introduction-images",u);const it=I("videos",u),st=f("bids",u);f("bigbuttonPlayerMap",u);const ot=f("commentatorsNew",u),at=f("countdown",u),ut=f("currentRunDelay",u),ft=f("delayedTimer",u),ct=f("donationAlerts",u);f("donationReader",u);const lt=f("donationReaderNew",u),dt=f("donationsToRead",u),vt=f("donationTotal",u),ht=f("donationTotalMilestones",u),mt=f("fullScreenVideoPlayer",u),pt=f("gameLayouts",u),gt=f("intermissionSlides",u),yt=f("lowerThird",u),_t=f("mediaBox",u),bt=f("musicData",u);f("notableDonations",u);const wt=f("obsData",u),Rt=f("omnibar",u);f("otherStreamData",u);const Dt=f("prizes",u);f("readerIntroduction",u);const Ot=f("runDataArray",W),xt=f("runDataActiveRun",W),Lt=f("runDataActiveRunSurrounding",W),St=f("timer",W),{timer:Tt,twitchCommercialTimer:jt}=Xe,Ct=f("serverTimestamp",u),At=f("soloedBidID",u),Et=f("streamDeckData",u),Mt=f("ttsVoices",u),Pt=f("upcomingRunID",u),Bt=f("videoPlayer",u);export{Ot as A,at as B,tt as C,ct as D,ht as E,Bt as F,it as G,wt as H,Ct as I,ut as J,Mt as K,Lt as L,mt as M,ge as S,lt as a,St as b,ot as c,ft as d,st as e,nt as f,pt as g,jt as h,gt as i,vt as j,Pt as k,yt as l,bt as m,_t as n,rt as o,Dt as p,et as q,xt as r,Xe as s,Tt as t,f as u,L as v,Rt as w,dt as x,Et as y,At as z};
