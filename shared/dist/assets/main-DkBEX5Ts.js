import{d as R,y as _,c as M,J as l,L as C,o as m,n as ee,A as a,j as n,b as k,a as c,D as A,B as p,t as D,F as I,i as te,k as F,r as ne,l as oe,m as ae}from"./index-CWzvgqpS.js";import{v as le}from"./vuetify-BmC0pzeD.js";import{v as $,D as i,h as w,q as ie}from"./replicant_store-BPC1BbL0.js";import{l as H}from"./lodash-Cn84nazp.js";import{M as de}from"./MediaCard-CdWsFjso.js";import{v as se}from"./v4-CtRu48qb.js";import"./_commonjsHelpers-BosuxZz1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"flex-grow-1"},me={key:0,class:"light-green--text accent-3 font-weight-bold pr-2"},re={key:1,class:"d-flex pr-2"},pe={key:2,class:"d-flex pr-2"},ve=R({__name:"Milestone",props:{milestone:{},index:{}},setup(h){const o=h,v=_(!1),g=_(""),f=_(!1),d=_("0"),r=_("0"),x=_(!1),V=M(()=>{var e;return(e=$.data)==null?void 0:e.pin}),S=M({get:()=>o.milestone.enabled,set:e=>{const t=i.data;if(!t)return;const u=t.find(E=>E.id===o.milestone.id);u&&(u.addition||u.amount)&&(u.enabled=e,u.addition&&(u.amount=e?(w.data??0)+u.addition:void 0)),i.save()}}),T=M(()=>!!(o.milestone.amount&&(w.data??0)>=o.milestone.amount)),B=M(()=>{var e,t;return((e=V.value)==null?void 0:e.type)==="Milestone"&&((t=V.value)==null?void 0:t.id)===o.milestone.id});function y(e){return!!e||"Required"}function b(e){return!Number.isNaN(Number(e))||"Must be a number"}function U(e){const t=Number(e);return!!t&&t>0||"Must be bigger than 0"}function q(e){return e.toLocaleString("en-US",{maximumFractionDigits:0})}function j(){const e=!B.value;$.data.pin=e?{type:"Milestone",id:o.milestone.id}:null,$.save()}function z(){var e,t;v.value=!0,g.value=o.milestone.name,f.value=!!o.milestone.addition,d.value=((e=o.milestone.addition)==null?void 0:e.toString())??"0",r.value=((t=o.milestone.amount)==null?void 0:t.toString())??"0"}function J(){if(!i.data)return;const e={id:o.milestone.id,name:g.value,enabled:o.milestone.enabled};o.milestone.enabled?(e.addition=o.milestone.addition,e.amount=o.milestone.amount):(e.addition=f.value?Number(d.value):void 0,e.amount=f.value?void 0:Number(r.value));const t=i.data.findIndex(u=>u.id===e.id);t>-1&&(i.data[t]=ie(e),i.save()),v.value=!1}function O(){if(!i.data)return;const e=i.data.findIndex(t=>t.id===o.milestone.id);e>-1&&(i.data.splice(e,1),i.save())}return(e,t)=>{const u=l("v-text-field"),E=l("v-switch"),Z=l("v-form"),G=l("v-card-text"),K=l("v-spacer"),P=l("v-btn"),Q=l("v-card-actions"),W=l("v-card"),X=l("v-dialog"),Y=l("v-checkbox"),N=l("v-icon");return m(),C(de,{class:"d-flex align-center px-2",style:ee({"text-align":"unset",height:"40px","margin-top":e.index>0?"10px":0})},{default:a(()=>[n(X,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=s=>v.value=s)},{default:a(()=>[n(W,null,{default:a(()=>[n(G,{class:"pa-4 pb-0"},{default:a(()=>[n(Z,{modelValue:x.value,"onUpdate:modelValue":t[4]||(t[4]=s=>x.value=s)},{default:a(()=>[n(u,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),"prepend-icon":"mdi-application",autocomplete:"off",rules:[y],filled:"",dense:""},null,8,["modelValue","rules"]),n(E,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),class:"pa-0 ma-0 pb-2 pl-10",label:'Toggle "Addition" Mode',"hide-details":"",inset:"",disabled:e.milestone.enabled},null,8,["modelValue","disabled"]),f.value?(m(),C(u,{key:0,modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),"prepend-icon":"mdi-cash-plus",autocomplete:"off",rules:[y,b,U],filled:"",dense:"",disabled:e.milestone.enabled},null,8,["modelValue","rules","disabled"])):(m(),C(u,{key:1,modelValue:r.value,"onUpdate:modelValue":t[3]||(t[3]=s=>r.value=s),"prepend-icon":"mdi-cash",autocomplete:"off",rules:[y,b,U],filled:"",dense:"",disabled:e.milestone.enabled},null,8,["modelValue","rules","disabled"]))]),_:1},8,["modelValue"])]),_:1}),n(Q,null,{default:a(()=>[n(K),n(P,{onClick:J,disabled:!x.value},{default:a(()=>t[8]||(t[8]=[p("Save")])),_:1},8,["disabled"]),n(P,{onClick:t[5]||(t[5]=s=>v.value=!1)},{default:a(()=>t[9]||(t[9]=[p("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(Y,{class:"pa-0 ma-0","hide-details":"",modelValue:S.value,"onUpdate:modelValue":t[7]||(t[7]=s=>S.value=s),disabled:!e.milestone.amount&&!e.milestone.addition},null,8,["modelValue","disabled"]),k("div",ue,D(e.milestone.name),1),T.value?(m(),c("div",me,"MET!")):A("",!0),e.milestone.amount?(m(),c("div",re,[n(N,{class:"pr-1"},{default:a(()=>t[10]||(t[10]=[p("mdi-cash")])),_:1}),k("div",null,"€"+D(q(e.milestone.amount)),1)])):A("",!0),e.milestone.addition?(m(),c("div",pe,[n(N,{class:"pr-1"},{default:a(()=>t[11]||(t[11]=[p("mdi-cash-plus")])),_:1}),p(" €"+D(q(e.milestone.addition)),1)])):A("",!0),n(N,{onClick:j,disabled:!e.milestone.amount&&!e.milestone.addition||!e.milestone.enabled},{default:a(()=>[B.value?(m(),c(I,{key:0},[p("mdi-pin-off")],64)):(m(),c(I,{key:1},[p("mdi-pin")],64))]),_:1},8,["disabled"]),n(N,{onClick:z},{default:a(()=>t[12]||(t[12]=[p(" mdi-pencil ")])),_:1}),n(N,{onClick:O,disabled:e.milestone.enabled},{default:a(()=>t[13]||(t[13]=[p(" mdi-delete ")])),_:1},8,["disabled"])]),_:1},8,["style"])}}}),fe={class:"mb-2 d-flex"},ce={key:0,class:"pa-3 font-italic"},be={key:1,style:{height:"350px","overflow-y":"scroll","margin-top":"10px"}},_e=R({__name:"main",setup(h){te({title:"Donation total milestones"});const o=_(2),v=M(()=>o.value===1?H.sortBy(i.data,["name"]):o.value===2?H.sortBy(i.data,d=>d.addition?(w.data??0)+d.addition:d.amount):i.data);function g(d){return d.toLocaleString("en-US",{maximumFractionDigits:2})}function f(){var d;(d=i.data)==null||d.push({id:se(),name:"Default Milestone Name",enabled:!1}),i.save()}return(d,r)=>{const x=l("v-spacer"),V=l("v-radio"),S=l("v-radio-group"),T=l("v-btn"),B=l("v-app");return typeof F(w).data<"u"&&F(i).data?(m(),C(B,{key:0},{default:a(()=>{var y;return[k("div",fe,[k("div",null,[r[1]||(r[1]=k("span",{class:"font-weight-bold"},"Donation Total:",-1)),p(" €"+D(g(F(w).data)),1)]),n(x),k("div",null,[n(S,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=b=>o.value=b),inline:"",class:"pa-0 ma-0","hide-details":"",label:"Sort By"},{default:a(()=>[n(V,{label:"Added",value:0}),n(V,{label:"Name",value:1}),n(V,{label:"Amount",value:2,class:"mr-0"})]),_:1},8,["modelValue"])])]),n(T,{onClick:f},{default:a(()=>r[2]||(r[2]=[p("Add New Milestone")])),_:1}),(y=v.value)!=null&&y.length?(m(),c("div",be,[(m(!0),c(I,null,ne(v.value,(b,U)=>(m(),C(ve,{key:b.id,milestone:b,index:U},null,8,["milestone","index"]))),128))])):(m(),c("div",ce," No milestones created, add a new one with the button above. "))]}),_:1})):A("",!0)}}}),L=oe(_e),ge=ae();L.use(ge);L.use(le);L.mount("#app");
