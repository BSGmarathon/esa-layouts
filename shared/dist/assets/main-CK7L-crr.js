import{N as f,K as g,o as d,A as n,J as ot,d as I,a as b,j as s,b as m,B as p,k as t,t as y,V as S,D as $,F as R,y as U,f as lt,n as at,P as st,i as it,l as rt,m as ut}from"./index-Ce_smM0X.js";import{v as dt}from"./vuetify-BC_h0XMe.js";import{d as pt,c as ct}from"./pinia-ey_1N9KB.js";import{D as T}from"./vuedraggable.umd-CwaN1Msl.js";import{n as M,p as w,k as u,q as j}from"./replicant_store-BlOELdrX.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{v as ft}from"./v4-CtRu48qb.js";import{w as mt}from"./helpers-Cfq79ybz.js";import"./_commonjsHelpers-BosuxZz1.js";const _t={};function vt(a,l){const o=f("v-card");return d(),g(o,{style:{"text-align":"center",padding:"5px","margin-top":"10px","white-space":"nowrap",overflow:"hidden"}},{default:n(()=>[ot(a.$slots,"default")]),_:3})}const A=q(_t,[["render",vt]]);function z(a){return["donation","subscription","cheer","merch","therungg"].includes(a)}function D(a){let l;if(a.type==="prize_generic")return{name:"Generic Prize Slide"};if(a.type==="image")l=M.value.find(o=>o.sum===a.mediaUUID);else if(a.type==="prize")l=w.data.find(o=>o.id.toString()===a.mediaUUID);else if(a.type==="text")return{name:a.text?a.text:"Custom Text"};return l?{name:l.name}:{}}function P(a,l,o){return{type:a,id:ft(),mediaUUID:l||"-1",text:o,seconds:60,showOnIntermission:!0}}function N(a){return!(a!=null&&a.startTime)&&!(a!=null&&a.endTime)?!0:!!(a&&a.startTime&&a.endTime&&Date.now()>a.startTime&&Date.now()<a.endTime)}const yt={style:{"max-height":"400px","overflow-y":"auto"}},gt=I({__name:"AvailableImages",setup(a){const{bundleName:l}=nodecg;function o(c){return P("image",c.sum)}return(c,e)=>{const i=f("v-toolbar-title");return d(),b("div",null,[s(i,null,{default:n(()=>e[0]||(e[0]=[p(" Available Images ")])),_:1}),m("div",yt,[t(M).length?(d(),g(t(T),{key:1,list:t(M),group:{name:"media",pull:"clone",put:!1},sort:!1,clone:o,"item-key":"sum"},{item:n(({element:x})=>[s(A,null,{default:n(()=>[p(y(x.name),1)]),_:2},1024)]),_:1},8,["list"])):(d(),g(A,{key:0,style:{"font-style":"italic","white-space":"unset"}},{default:n(()=>[p(' Add images under "Assets" > "'+y(t(l))+'" > "Media Box Images". ',1)]),_:1}))])])}}}),O=I({__name:"ApplicableIcon",props:{isApplicable:{type:Boolean}},setup(a){return(l,o)=>{const c=f("v-icon"),e=f("v-tooltip");return l.isApplicable?(d(),g(e,{key:0,right:""},{activator:n(({targetRef:i})=>[s(c,S(i),{default:n(()=>o[0]||(o[0]=[p(" mdi-check ")])),_:2},1040)]),default:n(()=>[o[1]||(o[1]=m("span",null,"Applicable",-1))]),_:1})):l.isApplicable?(d(),g(e,{key:2,right:""},{activator:n(({targetRef:i})=>[s(c,S(i),{default:n(()=>o[4]||(o[4]=[p(" mdi-help ")])),_:2},1040)]),default:n(()=>[o[5]||(o[5]=m("span",null,"Unknown",-1))]),_:1})):(d(),g(e,{key:1,right:""},{activator:n(({targetRef:i})=>[s(c,S(i),{default:n(()=>o[2]||(o[2]=[p(" mdi-close ")])),_:2},1040)]),default:n(()=>[o[3]||(o[3]=m("span",null,"Not Currently Applicable",-1))]),_:1}))}}}),xt={key:0},bt={style:{"max-height":"400px","overflow-y":"auto"}},kt=["title"],wt=I({__name:"AvailablePrizes",setup(a){function l(c){return P("prize",c.id.toString())}function o(){return P("prize_generic")}return(c,e)=>{var x;const i=f("v-toolbar-title");return t(w).data?(d(),b("div",xt,[s(i,null,{default:n(()=>e[0]||(e[0]=[p(" Available Prizes ")])),_:1}),m("div",bt,[(x=t(w).data)!=null&&x.length?(d(),g(t(T),{key:1,list:t(w).data,group:{name:"media",pull:"clone",put:!1},sort:!1,clone:l,"item-key":"id"},{item:n(({element:k})=>[s(A,{class:"d-flex"},{default:n(()=>[s(O,{"is-applicable":t(N)(k)},null,8,["is-applicable"]),m("div",{class:"flex-grow-1",title:k.name},y(k.name),9,kt)]),_:2},1024)]),_:1},8,["list"])):(d(),g(A,{key:0,style:{"font-style":"italic"}},{default:n(()=>e[1]||(e[1]=[p(" No prizes available from the tracker. ")])),_:1})),s(t(T),{list:["generic_prize"],group:{name:"media",pull:"clone",put:!1},sort:!1,clone:o},{item:n(()=>[s(A,{key:"generic_prize",class:"d-flex",style:{"font-weight":"500"}},{default:n(()=>[s(O,{"is-applicable":!!t(w).data.filter(t(N)).length},null,8,["is-applicable"]),e[2]||(e[2]=m("div",{class:"flex-grow-1",title:"Generic Prize Slide"}," Generic Prize Slide ",-1))]),_:1})]),_:1})])])):$("",!0)}}}),$t={key:0},At={class:"Status"},Ct={key:0,style:{"font-style":"italic"}},Vt={style:{"text-transform":"capitalize"}},It={key:3},St={key:0,class:"Status"},Ut=I({__name:"CurrentMediaInfo",setup(a){function l(e){var i,x;return e&&z(e.type)?15:((x=(i=u.data)==null?void 0:i.rotationApplicable.find(k=>k.id===(e==null?void 0:e.id)))==null?void 0:x.seconds)||0}function o(e){return Math.round(l(e)-((e==null?void 0:e.timeElapsed)||0)/1e3)}function c(e){const i=e==null?void 0:e.index;return typeof i=="number"?i+1:-1}return(e,i)=>t(u).data?(d(),b("div",$t,[m("div",At,[t(u).data.current?t(u).data.current?(d(),b(R,{key:1},[i[1]||(i[1]=m("span",{class:"font-weight-bold"},"Current:",-1)),t(z)(t(u).data.current.type)?(d(),b(R,{key:0},[m("span",Vt,y(t(u).data.current.type),1),i[0]||(i[0]=p(" Alert "))],64)):(d(),b(R,{key:1},[p(y(t(D)(t(u).data.current).name),1)],64)),i[2]||(i[2]=m("br",null,null,-1)),t(z)(t(u).data.current.type)?(d(),b("span",It,"(")):(d(),b(R,{key:2},[p(" (position "+y(c(t(u).data.current))+"/"+y(t(u).data.rotationApplicable.length)+", ",1)],64)),p(y(o(t(u).data.current))+"/"+y(l(t(u).data.current))+"s left) ",1)],64)):$("",!0):(d(),b("span",Ct," No media currently displaying. "))]),t(u).data.paused?(d(),b("div",St,[i[3]||(i[3]=m("span",{class:"font-weight-bold"},"Paused:",-1)),p(" "+y(t(D)(t(u).data.paused).name)+" ",1),i[4]||(i[4]=m("br",null,null,-1)),p("(position "+y(c(t(u).data.paused))+"/"+y(t(u).data.rotationApplicable.length)+", "+y(o(t(u).data.paused))+"/"+y(l(t(u).data.paused))+"s left) ",1)])):$("",!0)])):$("",!0)}}),Dt=q(Ut,[["__scopeId","data-v-50b71700"]]),J=pt("mediaBoxControl",()=>{const a=U([]),l=U(!1);async function o(){l.value=!0,u.data.rotation=j(a.value),u.save(),await new Promise(c=>{setTimeout(c,1e3)}),l.value=!1}return{newRotation:a,disableSave:l,save:o}}),Tt={key:0},Bt={style:{"max-height":"400px","overflow-y":"auto"}},Rt=["title"],Mt={class:"d-flex"},Pt=I({__name:"Rotation",setup(a){const l=J(),o=U(!1),c=U(""),e=U("");lt(async()=>{await mt(w,u),l.newRotation=j(u.data.rotation)});function i(v){var r,B;if(v.showOnIntermission)return v.type==="image"?!!M.value.find(C=>C.sum===v.mediaUUID):v.type==="prize_generic"?!!((r=w.data)!=null&&r.filter(C=>N(C)).length):v.type==="prize"?N((B=w.data)==null?void 0:B.find(C=>C.id.toString()===v.mediaUUID)):v.type==="text"}function x(v){l.newRotation[v].seconds=Number(l.newRotation[v].seconds)}function k(){const v=l.newRotation.findIndex(r=>r.id===c.value);v>=0&&(l.newRotation[v].text=e.value),e.value="",c.value="",o.value=!1}function E(v){l.newRotation.splice(v,1)}return(v,r)=>{const B=f("v-textarea"),C=f("v-form"),K=f("v-card-text"),L=f("v-spacer"),G=f("v-btn"),Y=f("v-card-actions"),Q=f("v-card"),W=f("v-dialog"),X=f("v-toolbar-title"),Z=f("v-checkbox"),tt=f("v-tooltip"),et=f("v-text-field"),F=f("v-icon");return t(u).data&&t(w).data?(d(),b("div",Tt,[s(W,{class:"Dialog",modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=_=>o.value=_),persistent:""},{default:n(()=>[s(Q,null,{default:n(()=>[r[6]||(r[6]=m("div",{class:"pa-4 pb-0"}," Text entered here can include Markdown for styling purposes. ",-1)),s(K,{class:"pa-4 pb-0"},{default:n(()=>[s(C,null,{default:n(()=>[s(B,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=_=>e.value=_),label:"Text",autocomplete:"off",filled:"",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(Y,null,{default:n(()=>[s(L),s(G,{onClick:k},{default:n(()=>r[4]||(r[4]=[p("Save")])),_:1}),s(G,{onClick:r[1]||(r[1]=_=>{o.value=!1,e.value="",c.value=""})},{default:n(()=>r[5]||(r[5]=[p("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(X,null,{default:n(()=>r[7]||(r[7]=[p(" Rotation ")])),_:1}),m("div",Bt,[t(l).newRotation.length?$("",!0):(d(),g(A,{key:0,style:{"font-style":"italic"}},{default:n(()=>r[8]||(r[8]=[p(" Drag elements from above to here to configure. ")])),_:1})),s(t(T),{modelValue:t(l).newRotation,"onUpdate:modelValue":r[3]||(r[3]=_=>t(l).newRotation=_),group:"media","item-key":"id"},{item:n(({element:_,index:H})=>[s(A,{class:"d-flex"},{default:n(()=>[s(O,{"is-applicable":i(_)},null,8,["is-applicable"]),m("div",{class:"d-flex align-center justify-center flex-grow-1",title:t(D)(_).name,style:at({overflow:"hidden","font-weight":_.type==="prize_generic"?"500":void 0,"font-style":t(D)(_).name?void 0:"italic"})},y(t(D)(_).name||"Could not find media name."),13,Rt),m("div",Mt,[s(tt,{left:""},{activator:n(({targetRef:V})=>[m("div",S(V,!0),[s(Z,st(S(V),{modelValue:_.showOnIntermission,"onUpdate:modelValue":nt=>_.showOnIntermission=nt,dense:"",class:"ma-0 pa-0","hide-details":""}),null,16,["modelValue","onUpdate:modelValue"])],16)]),default:n(()=>[r[9]||(r[9]=m("span",null,"Show On Intermission",-1))]),_:2},1024),s(et,{modelValue:_.seconds,"onUpdate:modelValue":V=>_.seconds=V,class:"pa-0 ma-0",type:"number",label:"Seconds","hide-details":"auto",density:"compact",style:{width:"90px !important"},onInput:V=>x(H)},null,8,["modelValue","onUpdate:modelValue","onInput"]),_.type==="text"?(d(),g(F,{key:0,onClick:V=>{c.value=_.id,e.value=_.text||"",o.value=!0}},{default:n(()=>r[10]||(r[10]=[p(" mdi-pencil ")])),_:2},1032,["onClick"])):$("",!0),s(F,{onClick:V=>E(H)},{default:n(()=>r[11]||(r[11]=[p(" mdi-delete ")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:1},8,["modelValue"])])])):$("",!0)}}}),Nt={style:{"margin-top":"20px"}},ht=I({__name:"App",props:{prizes:{type:Boolean,default:!0}},setup(a){it({title:"Media Box control"});const l=J();function o(){return P("text",void 0,"Your text here")}return(c,e)=>{const i=f("v-toolbar-title"),x=f("v-btn"),k=f("v-app");return d(),g(k,null,{default:n(()=>[s(gt),c.prizes?(d(),g(wt,{key:0,style:{"margin-top":"20px"}})):$("",!0),m("div",Nt,[s(i,null,{default:n(()=>e[1]||(e[1]=[p(" Custom Text Element ")])),_:1}),m("div",null,[s(t(T),{list:["text"],group:{name:"media",pull:"clone",put:!1},sort:!1,clone:o},{item:n(()=>[s(A,{key:"text",style:{"font-weight":"500"}},{default:n(()=>e[2]||(e[2]=[p(" Drag to rotation to configure a custom text element. ")])),_:1})]),_:1})])]),s(Pt,{style:{"margin-top":"20px"}}),s(x,{loading:t(l).disableSave,disabled:t(l).disableSave,style:{"margin-top":"20px"},onClick:e[0]||(e[0]=E=>t(l).save())},{default:n(()=>e[3]||(e[3]=[p(" Save ")])),_:1},8,["loading","disabled"]),s(Dt,{style:{"margin-top":"10px"}})]),_:1})}}}),h=rt(ht),zt=ut(),Ot=ct();h.use(zt);h.use(dt);h.use(Ot);h.mount("#app");
