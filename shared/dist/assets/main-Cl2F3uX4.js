import{d as I,c as b,N as o,a as _,o as r,j as n,A as s,i as M,y as N,z as V,f as F,K as A,k as K,F as O,r as E,b as x,B as R,l as L,m as U}from"./index-Ce_smM0X.js";import{v as G}from"./vuetify-BC_h0XMe.js";import{g as C,G as c}from"./replicant_store-BlOELdrX.js";import{w as T}from"./helpers-Cfq79ybz.js";import"./_commonjsHelpers-BosuxZz1.js";const $=I({__name:"RTMPFeed",props:{value:{}},setup(f){const i=[{prefix:"eu",name:"Europe"},{prefix:"na",name:"North-America"}],d=b(()=>f.value.editAllowed&&f.value.enabled);return(l,u)=>{const p=o("v-checkbox"),m=o("v-select"),v=o("v-col"),a=o("v-text-field"),e=o("v-row");return r(),_("div",null,[n(p,{disabled:!l.value.editAllowed,modelValue:l.value.enabled,"onUpdate:modelValue":u[0]||(u[0]=t=>l.value.enabled=t),label:`Feed ${l.value.feedIndex}`},null,8,["disabled","modelValue","label"]),n(e,null,{default:s(()=>[n(v,{cols:"5"},{default:s(()=>[n(m,{disabled:!d.value,modelValue:l.value.server,"onUpdate:modelValue":u[1]||(u[1]=t=>l.value.server=t),label:"Instance","item-text":"name","item-value":"prefix",items:i,"persistent-hint":"","single-line":""},null,8,["disabled","modelValue"])]),_:1}),n(v,null,{default:s(()=>[n(a,{label:"Stream key",modelValue:l.value.streamKey,"onUpdate:modelValue":u[2]||(u[2]=t=>l.value.streamKey=t),filled:"",disabled:!d.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),n(a,{label:"RTMP url",value:`rtmp://${l.value.server}.bsgmarathon.com/live`,readonly:"",filled:"",disabled:!d.value},null,8,["value","disabled"])])}}}),D=I({__name:"main",setup(f){M({title:"Restream viewer control"});const i=nodecg.bundleConfig.obs.names.scenes.gameLayout,d=nodecg.bundleConfig.event.online,l=N([{streamKey:"",editAllowed:!0,enabled:!0,feedIndex:1,server:"eu"},{streamKey:"",editAllowed:!0,enabled:!1,feedIndex:2,server:"na"}]),u=b(()=>{var a;return(a=C.data)==null?void 0:a.selected}),p=b(()=>l.value.map(a=>a.editAllowed).reduce((a,e)=>a||e,!1));async function m(){await nodecg.sendMessage("setRtmpSettings",l.value)}async function v(){const a=l.value.filter(e=>e.enabled).map(e=>e.feedIndex);await nodecg.sendMessage("refreshRtmpSources",a)}return V(()=>c.data,()=>{var e;if(!d)return;const a=((e=c.data)==null?void 0:e.scene)===i;for(const t of l.value)t.editAllowed=!a},{deep:!0}),V(u,async a=>{d&&(l.value[1].enabled=(a==null?void 0:a.includes("2p"))||!1,await m())}),F(async()=>{if(!d)return;await T(c,C),l.value=await nodecg.sendMessage("geRtmpSettings");const a=c.data.scene===i;for(const e of l.value)e.editAllowed=!a}),(a,e)=>{const t=o("v-btn"),y=o("v-col"),B=o("v-row"),w=o("v-app");return K(d)?(r(),A(w,{key:0},{default:s(()=>[(r(!0),_(O,null,E(l.value,k=>(r(),_("div",{key:k.feedIndex},[n($,{value:k},null,8,["value"]),e[0]||(e[0]=x("hr",null,null,-1))]))),128)),n(B,null,{default:s(()=>[n(y,null,{default:s(()=>[n(t,{disabled:!p.value,onClick:m},{default:s(()=>e[1]||(e[1]=[R("Update OBS")])),_:1},8,["disabled"])]),_:1}),n(y,null,{default:s(()=>[n(t,{onClick:v},{default:s(()=>e[2]||(e[2]=[R("Refresh active")])),_:1})]),_:1})]),_:1})]),_:1})):(r(),A(w,{key:1},{default:s(()=>e[3]||(e[3]=[x("p",null,"Disabled for in-person events",-1)])),_:1}))}}}),g=L(D),H=U();g.use(H);g.use(G);g.mount("#app");
